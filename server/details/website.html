

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Website &mdash; IceProd master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  
  
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
  
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="IceProd master documentation" href="../../index.html"/>
        <link rel="up" title="IceProd Server Details" href="index.html"/>
        <link rel="next" title="REST Authorization" href="auth.html"/>
        <link rel="prev" title="Asynchronous Programming" href="async.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> IceProd
          

          
          </a>

          
            
            
              <div class="version">
                2.5.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guide/index.html">User’s Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../guide/login.html">Login</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/submission.html">Dataset Submission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/datasets.html">Dataset Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/tasks.html">Task Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/restapi.html">REST API Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guide/manually.html">Running Manually</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../admin/index.html">Administrator’s Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../admin/startup.html">Server Startup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../admin/common.html">Common Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../admin/extra_details.html">Extras</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../core/index.html">IceProd Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../core/i3exec.html">I3Exec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/exe.html">Execution Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/exe_helper.html">Execution Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/exe_json.html">JSONRPC Calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/jsonRPCclient.html">JSON-RPC Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/jsonUtil.html">JSON Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/init.html">Core Init</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/dataclasses.html">Dataclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/parser.html">Meta-Language Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/serialization.html">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/gridftp.html">GridFTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/util.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">IceProd Server</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Server Details</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="submit_to_queue.html">From Submission to Queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_relationships.html">Task Relationships</a></li>
<li class="toctree-l3"><a class="reference internal" href="lifecycles.html">Lifecycles</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_queueing.html">Global Queueing</a></li>
<li class="toctree-l3"><a class="reference internal" href="async.html">Asynchronous Programming</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Website</a></li>
<li class="toctree-l3"><a class="reference internal" href="auth.html">REST Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_accounts.html">User Accounts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rest_api/index.html">REST API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/datasets.html">Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/config.html">Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/jobs.html">Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/tasks.html">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/task_stats.html">Task Stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/logs.html">Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/grids.html">Grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/pilots.html">Pilots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rest_api/auth.html">Auth</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../auth.html">Token Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config.html">Detailed Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmethods.html">DB Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_io.html">File IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../globus.html">Globus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grid.html">Grid Queueing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../init.html">Server Init</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module.html">Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nginx.html">Nginx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../schedule.html">Schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../server.html">Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../squid.html">Squid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ssl_cert.html">SSL/TLS Certificate Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tornado.html">Tornado Web Utilities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IceProd</a>
        
      </nav>


      
      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">IceProd Server</a> &raquo;</li>
        
          <li><a href="index.html">IceProd Server Details</a> &raquo;</li>
        
      <li>Website</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/server/details/website.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="website">
<h1>Website<a class="headerlink" href="#website" title="Permalink to this headline">¶</a></h1>
<p>The website is the main way to communicate with IceProd.  It handles several
different jobs:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Human</dt><dd><ul>
<li><p>dataset submission</p></li>
<li><p>dataset editing, other in progress actions</p></li>
<li><p>viewing progress</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Computer</dt><dd><ul>
<li><p>running task communications</p></li>
<li><p>site-to-site communications</p></li>
<li><p>file downloads</p></li>
<li><p>file proxying</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>In order to handle the many hundreds or thousands of requests it could get,
the website was built on <a class="reference internal" href="async.html#async"><span class="std std-ref">Asynchronous Programming</span></a>.</p>
<section id="task-communication">
<h2>Task Communication<a class="headerlink" href="#task-communication" title="Permalink to this headline">¶</a></h2>
<p>Tasks communicate with the server using a json-rpc interface built into the
website.  For most communications, this involves talking with the database
using the internal RPC.</p>
</section>
<section id="site-to-site-communication">
<h2>Site-to-Site Communication<a class="headerlink" href="#site-to-site-communication" title="Permalink to this headline">¶</a></h2>
<p>Communication between sites also use the json-rpc interface in the website.</p>
</section>
<section id="human-interaction">
<h2>Human Interaction<a class="headerlink" href="#human-interaction" title="Permalink to this headline">¶</a></h2>
<p>The website can modify things in the database using ajax and the json-rpc
interface in the website.</p>
</section>
<section id="nginx">
<h2>Nginx<a class="headerlink" href="#nginx" title="Permalink to this headline">¶</a></h2>
<p>The website uses nginx as a front end proxy.  Nginx handles all SSL
certificate checking, static files, and file uploading before proxying the
request to Tornado.</p>
<p>Note that Apache can also be used separately, while Nginx config is built-in.</p>
</section>
<section id="security">
<h2>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h2>
<p>Details about user accounts are in <span class="xref std std-ref">user_accounts</span>.</p>
<section id="csrf">
<h3>CSRF<a class="headerlink" href="#csrf" title="Permalink to this headline">¶</a></h3>
<p>To protect against Cross-Site Request Forgery (and other session-stealing
attacks), the following schemes are used:</p>
<section id="headers">
<h4>Headers<a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h4>
<p>If available, the <cite>Origin</cite> or <cite>Referer</cite> headers are checked.
If they are not available, JSON-RPC requests are passed while
other requests are blocked.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Why are JSON-RPC requests passed?</p>
<p>This is because JSON-RPC serves multiple purposes.  Only one of them
is for website requests.  One other is as an API for scripts or other
external entities.  But the main purpose is for IceProd task and site
communication.  In order to not hinder these uses, the headers are left
unchecked.</p>
<p>Note that JSON-RPC does not use the user login cookie, so it cannnot be
tricked into running cross-site requests that way.</p>
</div>
</section>
<section id="login">
<h4>Login<a class="headerlink" href="#login" title="Permalink to this headline">¶</a></h4>
<p>There are two different types of login, which are treated differently.</p>
<section id="web-login">
<h5>Web Login<a class="headerlink" href="#web-login" title="Permalink to this headline">¶</a></h5>
<p>The initial web login will save a secure cookie to identify the user, but
this will not in itself grant any access to JSON-RPC or secure areas. The
lifetime for the login is measured in days, and is configurable.</p>
<p>When loading a page that needs to make JSON-RPC requests, a very limited
lifetime passkey is generated (assume 15 minutes) and inserted in a hidden
field in the html.  This passkey is then added to JSON-RPC requests.</p>
<p>Secure areas like account details will require a second login before granting
access.</p>
</section>
<section id="json-rpc-login">
<h5>JSON-RPC Login<a class="headerlink" href="#json-rpc-login" title="Permalink to this headline">¶</a></h5>
<p>This version directly returns the passkey necessary to execute authenticated
JSON-RPC requests.  It has a fairly limited lifetime and is designed to be
used immediately within the same script.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Anyone with the passkey can impersonate you for the lifetime of the key.
Try not to save it to file, and dispose of it when finished.</p>
</div>
</section>
</section>
</section>
</section>
</section>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="auth.html" class="btn btn-neutral float-right" title="REST Authorization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="async.html" class="btn btn-neutral" title="Asynchronous Programming" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, IceCube Collaboration.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>