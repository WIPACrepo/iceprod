<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Website &#8212; IceProd 2.0.4 documentation</title>
    
    <link rel="stylesheet" href="../../_static/iceprod.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.0.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="IceProd 2.0.4 documentation" href="../../index.html" />
    <link rel="up" title="IceProd Server Details" href="index.html" />
    <link rel="next" title="ZeroMQ" href="zeromq.html" />
    <link rel="prev" title="Asynchronous Programming" href="async.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="zeromq.html" title="ZeroMQ"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="async.html" title="Asynchronous Programming"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">IceProd 2.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../details.html" >Technical Details</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">IceProd Server Details</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="website">
<h1>Website<a class="headerlink" href="#website" title="Permalink to this headline">¶</a></h1>
<p>The website is the main way to communicate with IceProd.  It handles several
different jobs:</p>
<ul>
<li><dl class="first docutils">
<dt>Human</dt>
<dd><ul class="first last simple">
<li>dataset submission</li>
<li>dataset editing, other in progress actions</li>
<li>viewing progress</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Computer</dt>
<dd><ul class="first last simple">
<li>running task communications</li>
<li>site-to-site communications</li>
<li>file downloads</li>
<li>file proxying</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>In order to handle the many hundreds or thousands of requests it could get,
the website was built on <a class="reference internal" href="async.html#async"><span class="std std-ref">Asynchronous Programming</span></a>.</p>
<div class="section" id="task-communication">
<h2>Task Communication<a class="headerlink" href="#task-communication" title="Permalink to this headline">¶</a></h2>
<p>Tasks communicate with the server using a json-rpc interface built into the
website.  For most communications, this involves talking with the database
using the internal RPC.</p>
</div>
<div class="section" id="site-to-site-communication">
<h2>Site-to-Site Communication<a class="headerlink" href="#site-to-site-communication" title="Permalink to this headline">¶</a></h2>
<p>Communication between sites also use the json-rpc interface in the website.</p>
</div>
<div class="section" id="human-interaction">
<h2>Human Interaction<a class="headerlink" href="#human-interaction" title="Permalink to this headline">¶</a></h2>
<p>The website can modify things in the database using ajax and the json-rpc
interface in the website.</p>
</div>
<div class="section" id="nginx">
<h2>Nginx<a class="headerlink" href="#nginx" title="Permalink to this headline">¶</a></h2>
<p>The website uses nginx as a front end proxy.  Nginx handles all SSL
certificate checking, static files, and file uploading before proxying the
request to Tornado.</p>
<p>Note that Apache can also be used separately, while Nginx config is built-in.</p>
</div>
<div class="section" id="security">
<h2>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h2>
<div class="section" id="user-accounts">
<h3>User Accounts<a class="headerlink" href="#user-accounts" title="Permalink to this headline">¶</a></h3>
<p>The default account is a username and password.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol">LDAP</a>
functionality can be enabled to authenticate supplied passwords against
LDAP.  This removes the ability to create new accounts or change passwords
from IceProd, as this needs to be done on the LDAP server.</p>
<p>An X509 (gridftp) proxy certificate can also be linked to an account for
use with datasets submitted by that user.</p>
</div>
<div class="section" id="csrf">
<h3>CSRF<a class="headerlink" href="#csrf" title="Permalink to this headline">¶</a></h3>
<p>To protect against Cross-Site Request Forgery (and other session-stealing
attacks), the following schemes are used:</p>
<div class="section" id="headers">
<h4>Headers<a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h4>
<p>If available, the <cite>Origin</cite> or <cite>Referer</cite> headers are checked.
If they are not available, JSON-RPC requests are passed while
other requests are blocked.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Why are JSON-RPC requests passed?</p>
<p>This is because JSON-RPC serves multiple purposes.  Only one of them
is for website requests.  One other is as an API for scripts or other
external entities.  But the main purpose is for IceProd task and site
communication.  In order to not hinder these uses, the headers are left
unchecked.</p>
<p class="last">Note that JSON-RPC does not use the user login cookie, so it cannnot be
tricked into running cross-site requests that way.</p>
</div>
</div>
<div class="section" id="login">
<h4>Login<a class="headerlink" href="#login" title="Permalink to this headline">¶</a></h4>
<p>There are two different types of login, which are treated differently.</p>
<div class="section" id="web-login">
<h5>Web Login<a class="headerlink" href="#web-login" title="Permalink to this headline">¶</a></h5>
<p>The initial web login will save a secure cookie to identify the user, but
this will not in itself grant any access to JSON-RPC or secure areas. The
lifetime for the login is measured in days, and is configurable.</p>
<p>When loading a page that needs to make JSON-RPC requests, a very limited
lifetime passkey is generated (assume 15 minutes) and inserted in a hidden
field in the html.  This passkey is then added to JSON-RPC requests.</p>
<p>Secure areas like account details will require a second login before granting
access.</p>
</div>
<div class="section" id="json-rpc-login">
<h5>JSON-RPC Login<a class="headerlink" href="#json-rpc-login" title="Permalink to this headline">¶</a></h5>
<p>This version directly returns the passkey necessary to execute authenticated
JSON-RPC requests.  It has a fairly limited lifetime and is designed to be
used immediately within the same script.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Anyone with the passkey can impersonate you for the lifetime of the key.
Try not to save it to file, and dispose of it when finished.</p>
</div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Website</a><ul>
<li><a class="reference internal" href="#task-communication">Task Communication</a></li>
<li><a class="reference internal" href="#site-to-site-communication">Site-to-Site Communication</a></li>
<li><a class="reference internal" href="#human-interaction">Human Interaction</a></li>
<li><a class="reference internal" href="#nginx">Nginx</a></li>
<li><a class="reference internal" href="#security">Security</a><ul>
<li><a class="reference internal" href="#user-accounts">User Accounts</a></li>
<li><a class="reference internal" href="#csrf">CSRF</a><ul>
<li><a class="reference internal" href="#headers">Headers</a></li>
<li><a class="reference internal" href="#login">Login</a><ul>
<li><a class="reference internal" href="#web-login">Web Login</a></li>
<li><a class="reference internal" href="#json-rpc-login">JSON-RPC Login</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="async.html"
                        title="previous chapter">Asynchronous Programming</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="zeromq.html"
                        title="next chapter">ZeroMQ</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/server/details/website.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="zeromq.html" title="ZeroMQ"
             >next</a> |</li>
        <li class="right" >
          <a href="async.html" title="Asynchronous Programming"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">IceProd 2.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../details.html" >Technical Details</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >IceProd Server Details</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, IceCube Collaboration.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.
    </div>
  </body>
</html>